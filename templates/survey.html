<!DOCTYPE html>
<html>
<head>
    <title>surveyed points</title>
    <!-- Include jQuery library -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Add surveyed points</h1>

    {% if message %}
    <pre>{{ message | safe }}</pre>
    {% endif %}

    {% if Num %}
        <form method="POST" action={{ url_for('calculate', filename=filename) }}>
            <div id="tableContainer">
                <!-- Use Jinja2 to generate the table based on the table_content data -->
                <table border="1">
                    <tr>
                        <th colspan="3" style="background-color: darkblue; color: white;">Source CRS (IFC) [{{ ifcunit }}]</th>
                        <th colspan="3">Target CRS (MAP) [{{ mapunit }}]</th>
                    </tr>
                    <tr>
                        <th style="background-color: darkblue; color: white;">X</th>
                        <th style="background-color: darkblue; color: white;">Y</th>
                        <th style="background-color: darkblue; color: white;">Z</th>
                        <th>X'</th>
                        <th>Y'</th>
                        <th>Z'</th>
                    </tr>
                    {% for row in range(Num) %}
                    <tr>
                        <td style="background-color: darkblue; color: white;"><input type="text" name="x{{ row }}"></td>
                        <td style="background-color: darkblue; color: white;"><input type="text" name="y{{ row }}"></td>
                        <td style="background-color: darkblue; color: white;"><input type="text" name="z{{ row }}"></td>
                        <td><input type="text" name="x_prime{{ row }}"></td>
                        <td><input type="text" name="y_prime{{ row }}"></td>
                        <td><input type="text" name="z_prime{{ row }}"></td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
            <input type="submit" value="Submit">
        </form>
    {% else %}
        <form method="POST">
                <label for="Num">Enter the number of extra surveyed points:</label>
                <input type="text" id="Num" name="Num">
                <input type="submit" value="Set">
        </form>
    {% endif %}

    <!-- Add script tag for the provided Java+jQuery code -->
    <script>
        $(document).ready(function() {
            $('input').bind('paste', function (e) {
                var $start = $(this);
                var source;

                //check for access to clipboard from window or event
                if (window.clipboardData !== undefined) {
                    source = window.clipboardData;
                } else {
                    source = e.originalEvent.clipboardData;
                }
                var data = source.getData("Text");
                if (data.length > 0) {
                    if (data.indexOf("\t") > -1) {
                        var columns = data.split("\n");
                        $.each(columns, function () {
                            var values = this.split("\t");
                            $.each(values, function () {
                                $start.val(this);
                                if ($start.closest('td').next('td').find('input,textarea')[0] != undefined || $start.closest('td').next('td').find('textarea')[0] != undefined) {
                                    $start = $start.closest('td').next('td').find('input,textarea');
                                }
                                else {
                                    return false;
                                }
                            });
                            $start = $start.closest('td').parent().next('tr').children('td:first').find('input,textarea');
                        });
                        e.preventDefault();
                    }
                }
            });

            // Enable cell navigation
            $.fn.enableCellNavigation = function () {
                // Provided enableCellNavigation function code
                // ...
            };

            // Call enableCellNavigation on tables
            $('table').enableCellNavigation();
        });
    </script>
</body>
</html>
